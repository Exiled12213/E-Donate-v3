<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>E-Donate</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="style/style.css">
    <script src="script/database.js" defer></script>
    <script src="script/script.js" defer></script>
    <script src="script/animations.js" defer></script>
    <style>        .primary-blue {
            background-color: rgb(37, 99, 235);
        }
        .footer-blue {
            background-color: rgb(30, 58, 138);
        }
        .view {
            display: none;
        }
        .view.active {
            display: block;
        }
        .rotate-180 {
            transform: rotate(180deg);
        }
        
        /* Fix for password eye icon */
        .password-eye-fix {
            position: absolute !important;
            top: 50% !important;
            right: 10px !important;
            transform: translateY(-50%) !important;
            height: auto !important;
            background: transparent !important;
            border: none !important;
            cursor: pointer !important;
            z-index: 10 !important;
        }
        
        /* Password field eye icon positioning - simplified approach */
        .password-field-container {
            position: relative;
        }
        
        .password-field-container input {
            width: 100%;
            padding-right: 35px;
        }
        
        .password-toggle-btn {
            position: absolute;
            top: 0;
            right: 0;
            height: 100%;
            width: 40px;
            background: transparent;
            border: none;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            outline: none;
        }
        
        /* Add styles for FAQ section */
        .w-full.px-4.py-3.text-left.flex.justify-between.items-center.hover\:bg-gray-50 {
            overflow: visible;
            white-space: normal;
            word-wrap: break-word;
            min-height: 48px; /* Ensure consistent height */
            align-items: flex-start; /* Align items at the top */
        }
        
        /* Ensure the icon stays aligned properly */
        .w-full.px-4.py-3.text-left.flex.justify-between.items-center.hover\:bg-gray-50 i {
            margin-top: 3px; /* Align icon with first line of text */
            flex-shrink: 0; /* Prevent icon from shrinking */
        }
        
        /* Ensure the FAQ content is also properly displayed */
        [id^="faq-"] {
            overflow: visible;
            white-space: normal;
            word-wrap: break-word;
            transition: max-height 0.3s ease-out;
            max-height: 0;
        }
        
        /* Style for visible FAQ content */
        [id^="faq-"]:not(.hidden) {
            padding: 1rem;
            max-height: 1000px; /* Large enough to contain content */
        }
    </style>
</head>
<body class="bg-gray-50 min-h-screen">
    <div id="app">
        <!-- Header -->
        <header class="primary-blue text-white shadow-md">
            <div class="container mx-auto px-4 py-4 flex justify-between items-center">
                <div class="flex items-center space-x-2">
                    <img src="img/edlogo.png" class="w-10">
                    <h1 class="text-xl font-bold">E-DONATE</h1>
                </div>
                
                <nav class="flex items-center space-x-4">
                    <button onclick="showView('home')" class="px-3 py-2 rounded-md text-sm font-medium text-white hover:bg-blue-700">
                        Home
                    </button>
                    <button onclick="showView('donate')" class="px-3 py-2 rounded-md text-sm font-medium text-white hover:bg-blue-700">
                        Donate
                    </button>
                    <button onclick="location.href='my_donations.html'" class="px-3 py-2 rounded-md text-sm font-medium text-white hover:bg-blue-700">
                        My Items
                    </button>
                    <button id="admin-dashboard-btn" onclick="window.location.href='admin_dashboard.html'" 
                            class="px-3 py-2 rounded-md text-sm font-medium text-white hover:bg-blue-700 hidden">
                        Admin Dashboard
                    </button>
                    <button onclick="login()" class="px-3 py-2 rounded-md text-sm font-medium text-white hover:bg-blue-700">
                        Sign In
                    </button>
                </nav>
            </div>
        </header>
        
        <!-- Home View -->
        <div id="home-view" class="view active">
            <!-- Hero Section -->
            <div class="primary-blue text-white">
                <div class="container mx-auto px-4 py-12">
                    <div class="max-w-3xl mx-auto text-center">
                        <img src="img/edlogo.png" class="px-20">
                        <h1 class="text-4xl font-bold mb-4">Old Gear, New Ideas</h1>
                        <p class="text-xl mb-8">A platform for UA Computer Engineering students's hardware needs.</p>
                        <button id="hero-button" onclick="login()" class="bg-white text-blue-600 hover:bg-gray-100 font-bold py-3 px-6 rounded-lg text-lg transition">
                            Sign In with UA Email
                        </button>
                    </div>
                </div>
            </div>
            
            <!-- Main Content -->
            <main class="container mx-auto px-4 py-8">
                <h2 class="text-2xl font-bold text-gray-800 mb-6">Announcements</h2>
                
                <div id="homepage-announcements" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 mb-10">
                    <!-- Announcements will be loaded dynamically -->
                    <div class="col-span-full text-center p-8">
                        <div class="inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"></div>
                        <p class="mt-2 text-gray-600">Loading announcements...</p>
                    </div>
                </div>
                
                <!-- Donation Gallery Section -->
                <div class="mt-12 mb-10">
                    <h2 class="text-2xl font-bold text-gray-800 mb-4">Donation Gallery</h2>
                    
                    <!-- Search Bar -->
                    <div class="mb-8">
                        <div class="relative max-w-md">
                            <input type="text" id="donation-search" placeholder="Search donated items..." 
                                class="w-full rounded-md border-gray-300 shadow-sm px-4 py-2 pl-10"
                                oninput="searchDonatedItems()">
                            <div class="absolute left-3 top-2.5 text-gray-400">
                                <i class="fas fa-search"></i>
                            </div>
                        </div>
                        
                        <!-- Component Filter -->
                        <div class="mt-3 flex items-center">
                            <label for="component-filter" class="mr-2 text-sm text-gray-600">Filter by component:</label>
                            <select id="component-filter" class="rounded-md border-gray-300 shadow-sm py-1 px-2 text-sm" onchange="filterByComponent()">
                                <option value="all">All Components</option>
                                <option value="microcontrollers">Microcontrollers and Boards</option>
                                <option value="sensors">Sensors and Modules</option>
                                <option value="wires">Wires and Connectors</option>
                                <option value="power">Power Supply</option>
                                <option value="display">Display Screens</option>
                                <option value="prototyping">Prototyping Materials</option>
                                <option value="components">Electronic Components</option>
                                <option value="cables">Cables and Adapters</option>
                                <option value="projects">Past Projects</option>
                                <option value="tools">Tools and Equipment</option>
                            </select>
                        </div>
                    </div>
                    
                    <!-- Categories and Items -->
                    <div id="donation-categories" class="space-y-8">
                        <!-- Categories will be populated by JavaScript -->
                        <div class="text-center p-8">
                            <div class="inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"></div>
                            <p class="mt-2 text-gray-600">Loading donation gallery...</p>
                        </div>
                    </div>
                </div>
            </main>
        </div>
        
        <!-- Donate View -->
        <div id="donate-view" class="view">
            <div class="primary-blue text-white py-12">
                <div class="container mx-auto px-4 text-center">
                    <h1 class="text-3xl font-bold mb-4">Donate Your Electronics</h1>
                    <p class="text-xl max-w-2xl mx-auto">Help fellow UA Computer Engineering students by donating electronics you no longer need.</p>
                </div>
            </div>
            
            <div class="container mx-auto px-4 py-8">
                <div class="max-w-4xl mx-auto bg-white rounded-lg shadow-md p-6">
                    <div class="text-center mb-8">
                        <h2 class="text-2xl font-bold text-gray-800">How It Works</h2>
                        <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mt-6">
                            <div class="bg-blue-50 p-4 rounded-lg">
                                <div class="bg-blue-100 w-12 h-12 rounded-full flex items-center justify-center mx-auto mb-3">
                                    <i class="fas fa-laptop text-blue-600 text-xl"></i>
                                </div>
                                <h3 class="font-semibold text-gray-800">1. List Your Item</h3>
                                <p class="text-gray-600 mt-2 text-sm">Fill out the form with details about your electronics.</p>
                            </div>
                            <div class="bg-blue-50 p-4 rounded-lg">
                                <div class="bg-blue-100 w-12 h-12 rounded-full flex items-center justify-center mx-auto mb-3">
                                    <i class="fas fa-check-circle text-blue-600 text-xl"></i>
                                </div>
                                <h3 class="font-semibold text-gray-800">2. Get Approved</h3>
                                <p class="text-gray-600 mt-2 text-sm">Our team will verify your donation request.</p>
                            </div>
                            <div class="bg-blue-50 p-4 rounded-lg">
                                <div class="bg-blue-100 w-12 h-12 rounded-full flex items-center justify-center mx-auto mb-3">
                                    <i class="fas fa-hands-helping text-blue-600 text-xl"></i>
                                </div>
                                <h3 class="font-semibold text-gray-800">3. Help a Student</h3>
                                <p class="text-gray-600 mt-2 text-sm">Your item will be matched with a student in need.</p>
                            </div>
                        </div>
                    </div>
                    
                    <div class="text-center mt-8">
                        <button onclick="openDonateModal()" class="bg-blue-600 hover:bg-blue-700 text-white font-bold py-3 px-8 rounded-lg text-lg transition flex items-center mx-auto">
                            <i class="fas fa-gift mr-2"></i> Donate Now
                        </button>
                    </div>
                </div>
                
                <div class="max-w-4xl mx-auto mt-8">
                    <h2 class="text-xl font-bold text-gray-800 mb-4">Frequently Asked Questions</h2>
                    <div class="bg-white rounded-lg shadow-md overflow-hidden">
                        <div class="border-b border-gray-200">
                            <button onclick="toggleFAQ(1)" class="w-full px-4 py-3 text-left flex justify-between items-center hover:bg-gray-50">
                                <span class="font-medium">What types of electronics can I donate?</span>
                                <i id="faq-icon-1" class="fas fa-chevron-down transition-transform duration-200"></i>
                            </button>
                            <div id="faq-1" class="px-4 py-3 bg-gray-50 hidden">
                                <p class="text-gray-600">We accept any working electronic components, tools, past projects for students to improve and other working equipment that can help students with their studies. This includes:</p>
                                <ul class="list-disc pl-5 mt-2 text-gray-600">
                                    <li>Microcontrollers and development boards (Arduino, Raspberry Pi, etc.)</li>
                                    <li>Sensors and modules (temperature, motion, light sensors, etc.)</li>
                                    <li>Electronic components (resistors, capacitors, ICs, etc.)</li>
                                    <li>Tools (soldering irons, multimeters, oscilloscopes, etc.)</li>
                                    <li>Past projects that can be repurposed or studied</li>
                                </ul>
                                <p class="text-gray-600 mt-2">All items must be in usable condition.</p>
                            </div>
                        </div>
                        <div class="border-b border-gray-200">
                            <button onclick="toggleFAQ(2)" class="w-full px-4 py-3 text-left flex justify-between items-center hover:bg-gray-50">
                                <span class="font-medium">How do I deliver my donated item?</span>
                                <i id="faq-icon-2" class="fas fa-chevron-down transition-transform duration-200"></i>
                            </button>
                            <div id="faq-2" class="px-4 py-3 bg-gray-50 hidden">
                                <p class="text-gray-600"><strong>For Students:</strong><br>
                                After your donation is approved, posted, and claimed by a student, they'll receive your email address to contact you about the donation. You can arrange a meeting point on campus for the handover.</p>
                                <p class="text-gray-600 mt-2"><strong>For Computer Engineering Graduates:</strong><br>
                                After your donation is approved, you'll receive instructions for dropping off your item at UA's Robotics Laboratory. The lab is open Monday-Friday from 9 AM to 4 PM for donation drop-offs.</p>
                            </div>
                        </div>
                        <div class="border-b border-gray-200">
                            <button onclick="toggleFAQ(3)" class="w-full px-4 py-3 text-left flex justify-between items-center hover:bg-gray-50">
                                <span class="font-medium">How long does the approval process take?</span>
                                <i id="faq-icon-3" class="fas fa-chevron-down transition-transform duration-200"></i>
                            </button>
                            <div id="faq-3" class="px-4 py-3 bg-gray-50 hidden">
                                <p class="text-gray-600">The approval process typically takes 1-2 business days. Our team reviews each donation to ensure it meets our guidelines and is suitable for student use. You'll receive an email notification once your donation is approved or if we need additional information.</p>
                            </div>
                        </div>
                        <div class="border-b border-gray-200">
                            <button onclick="toggleFAQ(4)" class="w-full px-4 py-3 text-left flex justify-between items-center hover:bg-gray-50">
                                <span class="font-medium">Can I donate broken or non-functioning items?</span>
                                <i id="faq-icon-4" class="fas fa-chevron-down transition-transform duration-200"></i>
                            </button>
                            <div id="faq-4" class="px-4 py-3 bg-gray-50 hidden">
                                <p class="text-gray-600">We generally accept items that are in working condition. However, we do accept some non-functioning items if they can be used for parts or repair practice. Please clearly indicate in your donation description if an item is not fully functional, and describe what is working and what isn't.</p>
                                <p class="text-gray-600 mt-2">Items that are completely broken or beyond repair may be rejected during the approval process.</p>
                            </div>
                        </div>
                        <div class="border-b border-gray-200">
                            <button onclick="toggleFAQ(5)" class="w-full px-4 py-3 text-left flex justify-between items-center hover:bg-gray-50">
                                <span class="font-medium">Can I see who receives my donation?</span>
                                <i id="faq-icon-5" class="fas fa-chevron-down transition-transform duration-200"></i>
                            </button>
                            <div id="faq-5" class="px-4 py-3 bg-gray-50 hidden">
                                <p class="text-gray-600">Yes, once your donation is claimed, you'll be able to see the name and email of the student who claimed it in your donation history. This allows you to coordinate the handover directly with them.</p>
                                <p class="text-gray-600 mt-2">For privacy reasons, you won't be able to see additional personal information about the recipient.</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- My Items View -->
        <div id="my-items-view" class="view">
            <div class="primary-blue text-white py-12">
                <div class="container mx-auto px-4 text-center">
                    <h1 class="text-3xl font-bold mb-4">My Donated Items</h1>
                    <p class="text-xl max-w-2xl mx-auto">View the electronics you've donated.</p>
                </div>
            </div>
            
            <div class="container mx-auto px-4 py-8">
                <div class="max-w-4xl mx-auto bg-white rounded-lg shadow-md p-6">
                    <div id="my-items-content" class="min-h-[200px]">
                        <!-- Content will be loaded dynamically -->
                    </div>
                </div>
            </div>
        </div>

        <!-- Sign In View -->
        <div id="signin-view" class="view">
            <div class="min-h-screen flex items-center justify-center bg-gray-50 py-12 px-4 sm:px-6 lg:px-8">
                <div class="max-w-md w-full space-y-8">
                    <div class="text-center">
                        <img src="img/edlogo.png" class="mx-auto h-24 w-auto bg-blue-600 p-3 rounded-lg shadow-md" alt="E-Donate Logo">
                        <h2 class="mt-6 text-3xl font-extrabold text-gray-900">
                            Sign in to your account
                        </h2>
                        <p class="mt-2 text-sm text-gray-600">
                            Use your UA.edu.ph email to access the platform
                        </p>
                    </div>
                    <div class="mt-8 bg-white py-8 px-4 shadow rounded-lg sm:px-10">
                        <form class="space-y-6" id="signin-form" onsubmit="handleSignIn(event)">
                            <div>
                                <label for="email" class="block text-sm font-medium text-gray-700">
                                    Email address
                                </label>
                                <div class="mt-1">
                                    <input id="email" name="email" type="email" autocomplete="email" required
                                        placeholder="your.email@ua.edu.ph"
                                        class="appearance-none block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm placeholder-gray-400 input-focus focus:outline-none focus:ring-2 focus:ring-blue-500 sm:text-sm">
                                </div>
                            </div>
                            
                            <div>
                                <label for="password" class="block text-sm font-medium text-gray-700">
                                    Password
                                </label>
                                <div class="mt-1 relative">
                                    <input id="password" name="password" type="password" autocomplete="current-password" required
                                        placeholder="Enter your password"
                                        class="appearance-none block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm placeholder-gray-400 input-focus focus:outline-none focus:ring-2 focus:ring-blue-500 sm:text-sm">
                                    <button type="button" onclick="togglePasswordVisibility('password')" class="password-eye-fix">
                                        <i id="password-eye" class="fas fa-eye text-gray-400 hover:text-gray-600"></i>
                                    </button>
                                </div>
                            </div>
                            
                            <div class="flex items-center justify-between">
                                <div class="text-sm">
                                    <button type="button" onclick="showRegistrationForm()" class="font-medium text-blue-600 hover:text-blue-500">
                                        Create an account
                                    </button>
                                </div>
                            </div>
                            
                            <div>
                                <button type="submit"
                                    class="w-full flex justify-center py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500">
                                    Sign in
                                </button>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
        </div>
        <!-- Terms Modal -->
        <div id="terms-modal" class="modal">
            <div class="modal-content">
                <div class="p-6">
                    <div class="flex justify-between items-center mb-4">
                        <h3 class="text-xl font-bold text-gray-800">Terms of Donation</h3>
                        <button onclick="closeTermsModal()" class="text-gray-400 hover:text-gray-500">
                            <i class="fas fa-times"></i>
                        </button>
                    </div>
                    
                    <div class="max-h-[70vh] overflow-y-auto">
                        <div class="p-5">
                            <h3 class="text-xl font-semibold text-blue-800 mb-3 flex items-center">
                                <span class="w-8 h-8 bg-blue-100 rounded-full flex items-center justify-center mr-3">1</span>
                                Donated Items
                            </h3>
                            <p class="text-gray-700 mb-4">
                                The Donor agrees to donate, and the Recipient agrees to accept, the items listed below or otherwise mutually agreed upon:
                            </p>
                            <ul class="space-y-2 pl-4">
                                <li class="term-item text-gray-700">Electronic components (e.g., resistors, ICs, microcontrollers, sensors)</li>
                                <li class="term-item text-gray-700">Past computer engineering projects (e.g., PCB designs, prototypes, source code)</li>
                                <li class="term-item text-gray-700">Tools used in engineering work (e.g., soldering equipment, multimeters, development boards)</li>
                            </ul>
                        </div>
                        
                        <div class="p-5">
                            <h3 class="text-xl font-semibold text-blue-800 mb-3 flex items-center">
                                <span class="w-8 h-8 bg-blue-100 rounded-full flex items-center justify-center mr-3">2</span>
                                Condition of Items
                            </h3>
                            <p class="text-gray-700">
                                All Donated Items are provided "as is" without any warranties, express or implied. The Donor does not guarantee the functionality, performance, or safety of the items, and the Recipient accepts the items in their current condition.
                            </p>
                        </div>
                        
                        <div class="p-5">
                            <h3 class="text-xl font-semibold text-blue-800 mb-3 flex items-center">
                                <span class="w-8 h-8 bg-blue-100 rounded-full flex items-center justify-center mr-3">3</span>
                                Transfer of Ownership
                            </h3>
                            <p class="text-gray-700">
                                Ownership of the Donated Items transfers from the Donor to the Recipient upon physical delivery or pick-up. Once delivered, the Donor waives all rights, responsibilities, or liabilities associated with the Donated Items.
                            </p>
                        </div>

                        <div class="p-5">
                            <h3 class="text-xl font-semibold text-blue-800 mb-3 flex items-center">
                                <span class="w-8 h-8 bg-blue-100 rounded-full flex items-center justify-center mr-3">4</span>
                                Use of Donated Items
                            </h3>
                            <p class="text-gray-700 mb-4">
                                The Recipient may:
                            </p>
                            <ul class="space-y-2 pl-4 mb-4">
                                <li class="term-item text-gray-700">Use the Donated Items for educational, experimental, repair, prototyping, or development purposes.</li>
                                <li class="term-item text-gray-700">Modify, dismantle, or redistribute the items unless restricted by law or specific agreements (e.g., licensed software or IP-protected projects).</li>
                            </ul>
                            <p class="text-gray-700">
                                The Recipient agrees not to use the Donated Items for any illegal or unethical purposes.
                            </p>
                        </div>

                        <div class="p-5">
                            <h3 class="text-xl font-semibold text-blue-800 mb-3 flex items-center">
                                <span class="w-8 h-8 bg-blue-100 rounded-full flex items-center justify-center mr-3">5</span>
                                Tax and Legal Considerations
                            </h3>
                            <p class="text-gray-700">
                                This donation is voluntary and non-monetary. Neither party makes any representation regarding the donation's eligibility for tax deduction. Both parties are advised to consult legal or tax professionals if necessary.
                            </p>
                        </div>

                        <div class="p-5">
                            <h3 class="text-xl font-semibold text-blue-800 mb-3 flex items-center">
                                <span class="w-8 h-8 bg-blue-100 rounded-full flex items-center justify-center mr-3">6</span>
                                Liability Waiver
                            </h3>
                            <p class="text-gray-700">
                                The Donor shall not be held liable for any damages, injuries, or losses resulting from the use or misuse of the Donated Items. The Recipient assumes full responsibility for handling and use of the items, including adherence to electrical safety standards and best practices.
                            </p>
                        </div>

                        <div class="p-5">
                            <h3 class="text-xl font-semibold text-blue-800 mb-3 flex items-center">
                                <span class="w-8 h-8 bg-blue-100 rounded-full flex items-center justify-center mr-3">7</span>
                                Acknowledgment
                            </h3>
                            <p class="text-gray-700 mb-4">
                                Both parties acknowledge that:
                            </p>
                            <ul class="space-y-2 pl-4">
                                <li class="term-item text-gray-700">The donation is voluntary.</li>
                                <li class="term-item text-gray-700">These Terms of Donation represent the entire understanding between the parties regarding the Donated Items.</li>
                            </ul>
                        </div>
                    </div>
                    
                    <div class="mt-6 flex justify-end">
                        <button onclick="closeTermsModal()" class="px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg">
                            Close
                        </button>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Donate Modal -->
        <div id="donate-modal" class="modal">
            <div class="modal-content">
                <div class="p-6">
                    <div class="flex justify-between items-center mb-4">
                        <h3 class="text-xl font-bold text-gray-800">Donate Electronics</h3>
                        <button onclick="closeModal()" class="text-gray-400 hover:text-gray-500">
                            <i class="fas fa-times"></i>
                        </button>
                    </div>
                    
                    <form id="donate-form" onsubmit="submitDonation(event)">
                        <div class="space-y-4">
                            <div>
                                <label for="item-name" class="block text-sm font-medium text-gray-700 mb-1">Item Name</label>
                                <input type="text" id="item-name" required class="w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500">
                            </div>
                            
                            <div>
                                <label for="item-type" class="block text-sm font-medium text-gray-700 mb-1">Item Type</label>
                                <select id="item-type" required class="w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500">
                                    <option value="">Select type</option>
                                    <option value="micro">Microcontrollers</option>
                                    <option value="sensors">Sensors and Modules</option>
                                    <option value="wires">Wires, Cables and Connectors</option>
                                    <option value="power">Power Supply</option>
                                    <option value="display">Display and Boards</option>
                                    <option value="components">Electronic Components</option>
                                    <option value="projects">Past Projects</option>
                                    <option value="prototype">Prototyping Materials</option>
                                    <option value="tools">Tools and Equiptment</option>
                                </select>
                            </div>
                            
                            <div>
                                <label for="item-condition" class="block text-sm font-medium text-gray-700 mb-1">Condition</label>
                                <select id="item-condition" required class="w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500">
                                    <option value="">Select condition</option>
                                    <option value="excellent">Excellent - Like new</option>
                                    <option value="good">Good - Minor wear</option>
                                    <option value="fair">Fair - Functional but with issues</option>
                                    <option value="poor">Poor - Needs repair</option>
                                </select>
                            </div>
                            
                            <div>
                                <label for="item-description" class="block text-sm font-medium text-gray-700 mb-1">Description</label>
                                <textarea id="item-description" rows="3" required class="w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500"></textarea>
                                <p class="mt-1 text-sm text-gray-500">Please include any important details about the item's functionality, accessories included, or known issues.</p>
                            </div>
                            
                            <div class="space-y-4">
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-1">Upload Photos</label>
                                    <div class="mt-1 flex justify-center px-6 pt-5 pb-6 border-2 border-gray-300 border-dashed rounded-md">
                                        <div class="space-y-1 text-center">
                                            <div class="flex text-sm text-gray-600">
                                                <label for="file-upload" class="relative cursor-pointer bg-white rounded-md font-medium text-blue-600 hover:text-blue-500 focus-within:outline-none">
                                                    <span>Upload images</span>
                                                    <input id="file-upload" name="file-upload" type="file" class="sr-only" multiple accept="image/jpeg, image/png, image/jpg">
                                                </label>
                                                <p class="pl-1">or drag and drop</p>
                                            </div>
                                            <p class="text-xs text-gray-500">PNG, JPG up to 5MB</p>
                                        </div>
                                    </div>
                                </div>
                                
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-1">Upload Video (Optional)</label>
                                    <div class="mt-1 flex justify-center px-6 pt-5 pb-6 border-2 border-gray-300 border-dashed rounded-md">
                                        <div class="space-y-1 text-center">
                                            <div class="flex text-sm text-gray-600">
                                                <label for="video-upload" class="relative cursor-pointer bg-white rounded-md font-medium text-blue-600 hover:text-blue-500 focus-within:outline-none">
                                                    <span>Upload video</span>
                                                    <input id="video-upload" name="video-upload" type="file" class="sr-only" accept="video/mp4, video/webm, video/ogg">
                                                </label>
                                                <p class="pl-1">or drag and drop</p>
                                            </div>
                                            <p class="text-xs text-gray-500">MP4, WEBM, OGG up to 30MB</p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="flex items-center">
                                <input id="terms-check" type="checkbox" required class="h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded">
                                <label for="terms-check" class="ml-2 block text-sm text-gray-700">
                                    I agree to the <a href="#" onclick="openTermsModal(); return false;" class="text-blue-600 hover:text-blue-500">Terms of Donation</a>
                                </label>
                            </div>
                        </div>
                        
                        <div class="mt-6 flex justify-end space-x-3">
                            <button type="button" onclick="closeModal()" class="px-4 py-2 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500">
                                Cancel
                            </button>
                            <button type="submit" class="px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500">
                                Submit Donation
                            </button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
        
        <!-- Success Modal -->
        <div id="success-modal" class="modal">
            <div class="modal-content">
                <div class="p-6 text-center">
                    <div class="mx-auto flex items-center justify-center h-12 w-12 rounded-full bg-green-100">
                        <i class="fas fa-check text-green-600 text-xl"></i>
                    </div>
                    <h3 class="mt-3 text-lg font-medium text-gray-900">Donation Submitted!</h3>
                    <div class="mt-2">
                        <p class="text-sm text-gray-500">Thank you for your donation. Our team will review your submission and contact you within 2 business days.</p>
                    </div>
                    <div class="mt-5">
                        <button onclick="closeSuccessModal()" type="button" class="inline-flex justify-center rounded-md border border-transparent shadow-sm px-4 py-2 bg-blue-600 text-base font-medium text-white hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 sm:text-sm">
                            Close
                        </button>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Registration View -->
        <div id="register-view" class="view">
            <div class="min-h-screen flex items-center justify-center bg-gray-50 py-12 px-4 sm:px-6 lg:px-8">
                <div class="max-w-md w-full space-y-8">
                    <div class="text-center">
                        <img src="img/edlogo.png" class="mx-auto h-24 w-auto bg-blue-600 p-3 rounded-lg shadow-md" alt="E-Donate Logo">
                        <h2 class="mt-6 text-3xl font-extrabold text-gray-900">
                            Create your account
                        </h2>
                        <p class="mt-2 text-sm text-gray-600">
                            Sign up with your UA.edu.ph email
                        </p>
                    </div>
                    <div class="mt-8 bg-white py-8 px-4 shadow rounded-lg sm:px-10">
                        <form class="space-y-6" id="registration-form" onsubmit="handleRegistration(event)">
                            <div>
                                <label for="reg-username" class="block text-sm font-medium text-gray-700">
                                    Username
                                </label>
                                <div class="mt-1">
                                    <input id="reg-username" name="username" type="text" required
                                        placeholder="Enter your username"
                                        class="appearance-none block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 sm:text-sm">
                                </div>
                            </div>

                            <div>
                                <label for="reg-email" class="block text-sm font-medium text-gray-700">
                                    Email address
                                </label>
                                <div class="mt-1">
                                    <input id="reg-email" name="email" type="email" required
                                        placeholder="your.email@ua.edu.ph"
                                        class="appearance-none block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 sm:text-sm">
                                </div>
                                <p class="mt-1 text-xs text-gray-500">Must be a valid UA.edu.ph email address</p>
                            </div>
                            
                            <div>
                                <label for="reg-password" class="block text-sm font-medium text-gray-700">
                                    Password
                                </label>
                                <div class="mt-1 relative">
                                    <input id="reg-password" name="password" type="password" required
                                        placeholder="Create a strong password"
                                        class="appearance-none block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 sm:text-sm">
                                    <button type="button" onclick="togglePasswordVisibility('reg-password')" class="password-eye-fix">
                                        <i id="reg-password-eye" class="fas fa-eye text-gray-400 hover:text-gray-600"></i>
                                    </button>
                                </div>
                                <p class="mt-1 text-xs text-gray-500">Must be at least 8 characters long</p>
                            </div>

                            <div>
                                <button type="submit"
                                    class="w-full flex justify-center py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500">
                                    Create Account
                                </button>
                            </div>

                            <div class="text-center">
                                <button type="button" onclick="showView('signin')" class="font-medium text-blue-600 hover:text-blue-500">
                                    Already have an account? Sign in
                                </button>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Footer -->
        <footer class="footer-blue text-white py-8">
            <div class="container mx-auto px-4">
                <div class="flex flex-col md:flex-row justify-between items-center">
                    <div class="mb-4 md:mb-0">
                        <h2 class="text-xl font-bold">E-DONATE : R.M.E.G.</h2>
                        <p class="text-gray-300 mt-1">For Students, By Students</p>
                        <div class="text-blue-300 hover:text-white">
                            <a href="terms.html">Terms of Donation</a>
                        </div>
                    </div>
                </div>
                <div class="mt-6 pt-6 border-t border-blue-800 text-center text-gray-300 text-sm">
                    © 2025 E-DONATE. All rights reserved.
                </div>
            </div>
        </footer>
    </div>
    
    <!-- Donation Details Modal -->
    <div id="donation-details-modal" class="modal">
        <div class="modal-content max-w-3xl">
            <div class="p-6">
                <div class="flex justify-between items-start mb-4">
                    <h3 class="text-xl font-bold text-gray-800" id="modal-donation-title">Donation Details</h3>
                    <button onclick="closeDonationDetailsModal()" class="text-gray-400 hover:text-gray-500">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
                
                <div id="modal-donation-content" class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <!-- Content will be loaded dynamically -->
                    <div class="text-center col-span-full p-6">
                        <div class="inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"></div>
                        <p class="mt-2 text-gray-600">Loading donation details...</p>
                    </div>
                </div>
                
                <!-- Status History Timeline Section -->
                <div id="donation-status-history" class="mt-8 pt-4 border-t border-gray-200">
                    <h4 class="text-lg font-semibold text-gray-800 mb-4">Status History</h4>
                    <div id="status-timeline" class="relative">
                        <!-- Status history will be loaded dynamically -->
                        <div class="text-center p-4">
                            <div class="inline-block animate-spin rounded-full h-6 w-6 border-b-2 border-blue-600"></div>
                            <p class="mt-2 text-gray-600">Loading status history...</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <script>
    async function handleSignIn(event) {
        event.preventDefault();
        
        const email = document.getElementById('email').value;
        const password = document.getElementById('password').value;
        
        const result = await loginUser(email, password);
        
        if (result.success) {
            // Store user info in session
            sessionStorage.setItem('user', JSON.stringify(result.user));
            
            // Show success modal instead of alert
            const username = result.user.username || email.split('@')[0];
            document.getElementById('login-success-message').textContent = `Welcome back, ${username}!`;
            document.getElementById('login-success-modal').style.display = 'block';
            
            // Update navigation for logged-in user
            updateNavigation(true);
            
            // After a short delay, redirect to home view
            setTimeout(() => {
                showView('home');
            }, 500);
        } else {
            // Show error modal instead of alert
            document.getElementById('login-error-message').textContent = result.message || 'Unable to sign in. Please check your credentials.';
            document.getElementById('login-error-modal').style.display = 'block';
            document.body.style.overflow = 'hidden';
        }
    }

    function updateNavigation(isLoggedIn) {
        const user = isLoggedIn ? JSON.parse(sessionStorage.getItem('user')) : null;
        const signInButton = document.querySelector('button[onclick="login()"]');
        const adminDashboardBtn = document.getElementById('admin-dashboard-btn');
        
        if (isLoggedIn && user) {
            signInButton.textContent = 'Sign Out';
            signInButton.onclick = logout;
            
            // Show admin dashboard button only for admin users
            if (user.is_admin && user.email === 'admin@ua.edu.ph') {
                adminDashboardBtn.classList.remove('hidden');
            } else {
                adminDashboardBtn.classList.add('hidden');
            }
        } else {
            signInButton.textContent = 'Sign In';
            signInButton.onclick = login;
            adminDashboardBtn.classList.add('hidden');
        }
    }

    function logout() {
        sessionStorage.removeItem('user');
        updateNavigation(false);
        showView('home');
        window.location.reload(); // Reload the page to reset all states
    }
    
    function closeLoginSuccessModal() {
        document.getElementById('login-success-modal').style.display = 'none';
    }
    
    function closeLoginErrorModal() {
        document.getElementById('login-error-modal').style.display = 'none';
        document.body.style.overflow = '';
    }
    
    function closeRegisterErrorModal() {
        document.getElementById('register-error-modal').style.display = 'none';
        document.body.style.overflow = '';
    }
    
    function closeRegisterSuccessModal() {
        document.getElementById('register-success-modal').style.display = 'none';
        document.body.style.overflow = '';
        showView('signin');
    }
    
    function togglePasswordVisibility(inputId) {
        const passwordInput = document.getElementById(inputId);
        const eyeIcon = document.getElementById(inputId + '-eye');
        
        if (passwordInput.type === 'password') {
            passwordInput.type = 'text';
            eyeIcon.classList.remove('fa-eye');
            eyeIcon.classList.add('fa-eye-slash');
        } else {
            passwordInput.type = 'password';
            eyeIcon.classList.remove('fa-eye-slash');
            eyeIcon.classList.add('fa-eye');
        }
    }

    // Check if user is already logged in
    window.onload = function() {
        const user = sessionStorage.getItem('user');
        if (user) {
            updateNavigation(true);
        }
    }

    function showRegistrationForm() {
        showView('register-view');
    }

    async function handleRegistration(event) {
        event.preventDefault();
        
        const username = document.getElementById('reg-username').value;
        const email = document.getElementById('reg-email').value;
        const password = document.getElementById('reg-password').value;

        // Validate email domain
        if (!email.endsWith('@ua.edu.ph')) {
            // Show error modal instead of alert
            document.getElementById('register-error-message').textContent = 'Please use a UA.edu.ph email address';
            document.getElementById('register-error-modal').style.display = 'block';
            document.body.style.overflow = 'hidden';
            return;
        }
        
        const result = await registerUser(username, email, password);
        
        if (result.success) {
            // Show success modal instead of alert
            document.getElementById('register-success-modal').style.display = 'block';
            document.body.style.overflow = 'hidden';
        } else {
            // Show error modal instead of alert
            document.getElementById('register-error-message').textContent = result.message || 'Registration failed';
            document.getElementById('register-error-modal').style.display = 'block';
            document.body.style.overflow = 'hidden';
        }
    }


    </script>
    
    <!-- Login Success Modal -->
    <div id="login-success-modal" class="modal">
        <div class="modal-content max-w-md">
            <div class="p-6 text-center">
                <div class="mb-4 flex justify-center">
                    <div class="rounded-full bg-green-100 p-3">
                        <svg class="h-12 w-12 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                        </svg>
                    </div>
                </div>
                <h3 class="text-xl font-bold text-gray-800 mb-2">Welcome Back!</h3>
                <p class="text-gray-600 mb-6" id="login-success-message">You have successfully logged in.</p>
                <button onclick="closeLoginSuccessModal()" class="bg-blue-600 hover:bg-blue-700 text-white font-medium py-2 px-6 rounded-lg">
                    Continue
                </button>
            </div>
        </div>
    </div>
    
    <!-- Login Error Modal -->
    <div id="login-error-modal" class="modal">
        <div class="modal-content max-w-md">
            <div class="p-6 text-center">
                <div class="mb-4 flex justify-center">
                    <div class="rounded-full bg-red-100 p-3">
                        <svg class="h-12 w-12 text-red-600" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"></path>
                        </svg>
                    </div>
                </div>
                <h3 class="text-xl font-bold text-gray-800 mb-2">Sign In Failed</h3>
                <p class="text-gray-600 mb-6" id="login-error-message">Unable to sign in. Please check your credentials.</p>
                <button onclick="closeLoginErrorModal()" class="bg-red-600 hover:bg-red-700 text-white font-medium py-2 px-6 rounded-lg">
                    Try Again
                </button>
            </div>
        </div>
    </div>
    
    <!-- Registration Error Modal -->
    <div id="register-error-modal" class="modal">
        <div class="modal-content max-w-md">
            <div class="p-6 text-center">
                <div class="mb-4 flex justify-center">
                    <div class="rounded-full bg-red-100 p-3">
                        <svg class="h-12 w-12 text-red-600" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"></path>
                        </svg>
                    </div>
                </div>
                <h3 class="text-xl font-bold text-gray-800 mb-2">Registration Failed</h3>
                <p class="text-gray-600 mb-6" id="register-error-message">Unable to complete registration.</p>
                <button onclick="closeRegisterErrorModal()" class="bg-red-600 hover:bg-red-700 text-white font-medium py-2 px-6 rounded-lg">
                    Try Again
                </button>
            </div>
        </div>
    </div>
    
    <!-- Registration Success Modal -->
    <div id="register-success-modal" class="modal">
        <div class="modal-content max-w-md">
            <div class="p-6 text-center">
                <div class="mb-4 flex justify-center">
                    <div class="rounded-full bg-green-100 p-3">
                        <svg class="h-12 w-12 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                        </svg>
                    </div>
                </div>
                <h3 class="text-xl font-bold text-gray-800 mb-2">Registration Successful!</h3>
                <p class="text-gray-600 mb-6">Your account has been created successfully. Please sign in.</p>
                <button onclick="closeRegisterSuccessModal()" class="bg-blue-600 hover:bg-blue-700 text-white font-medium py-2 px-6 rounded-lg">
                    Sign In
                </button>
            </div>
        </div>
    </div>
</body>
</html>